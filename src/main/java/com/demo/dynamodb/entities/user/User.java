package com.demo.dynamodb.entities.user;

import com.amazonaws.services.dynamodbv2.datamodeling.*;
import lombok.*;
import org.springframework.data.annotation.Id;

import java.util.Date;
import java.util.Set;

@Data
@NoArgsConstructor
@AllArgsConstructor
@DynamoDBTable(tableName = "user")
public class User {

	@Id
	@Getter(AccessLevel.NONE)
	@Setter(AccessLevel.NONE)
	private UserId userPrimaryKey;

	@DynamoDBAttribute(attributeName = "createdAt")
	private Date createdAt;

	@DynamoDBAttribute(attributeName = "userName")
	private String username;

	@DynamoDBAttribute(attributeName = "email")
	private String email;

	@DynamoDBAttribute(attributeName = "verified")
	private Boolean isVerified;

	@DynamoDBAttribute(attributeName = "role")
	private Set<String> role;

	@DynamoDBAttribute(attributeName = "companyId")
	private String companyId;

	@DynamoDBAutoGeneratedKey
	@DynamoDBHashKey(attributeName = "userId")
	public String getUserId() {
		return userPrimaryKey != null ? userPrimaryKey.getUserId() : null;
	}

	@DynamoDBRangeKey(attributeName = "updatedAt")
	public Date getUpdatedAt() {
		return userPrimaryKey != null ? userPrimaryKey.getUpdatedAt() : null;
	}

	public void setUserId(String userId) {
		if (userPrimaryKey == null) {
			userPrimaryKey = new UserId();
		}
		userPrimaryKey.setUserId(userId);
	}

	public void setUpdatedAt(Date updatedAt) {
		if (userPrimaryKey == null) {
			userPrimaryKey = new UserId();
		}
		userPrimaryKey.setUpdatedAt(updatedAt);
	}
}
